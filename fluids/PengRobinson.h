//PengRobinson.h#pragma once#include "../math/maths.h"#include "FluidCore.h"#include <string>#include "../iofile/iofile.h"using namespace std;const double TOK = 273.15;const double sqrt2=sqrt(2.0);//-------------------------------------------------/* FUNCTION EXTENSION CODES:	-	: base function, do not call directly	_a	: all zone	_g	: gas zone	_l	: liquid zone	_b  : biphasic zone	_s	: saturation line	_sl	: bubble line	_sg	: dew line (point de rosee)	_o	: ideal state (@ P = 0)*///-------------------------------------------------/*	FUNCTION CALLING CONVENTION:	1�)	parameters standard order: v,P,T,u,h,s,x	2�)	input parameters first (in standard order) then		output parameters (in standard order)	3�) for simultaneous liq & gas output:		global output parameters in standard order and		for each parameter first the liq and then the gas output*///-------------------------------------------------class PRfluid:public virtual FluidCore{	public://		char *FluidName;//		double Tref,href,sref,r;    //------------------------------------    //    PRfluid(const char *iFluidName, const char* file_in);    explicit PRfluid(const char *iFluidName);    //------------------------------------    PRfluid(char *iFluidName,            const double &ivc,            const double &iPc,            const double &iTc,            const double &iTnb,            const double &iMw,            const double &iw,            const double &iDipM,            const double &ic0,            const double &ic1,            const double &ic2,            const double &ic3,            const double &ic4);    //------------------------------------    PRfluid() = default;    void set(char *iFluidName,             const double &ivc,             const double &iPc,             const double &iTc,             const double &iTnb,             const double &iMw,             const double &iw,             const double &iDipM);    void set(	const double &ic0,                 const double &ic1,                 const double &ic2,                 const double &ic3,                 const double &ic4);    void set(	const double &iTref,                 const double &ihref,                 const double &isref);    void init() override;    //------------------------------------    // BASE FUNCTIONS (explicit functions)    // a coef. in PR EOS    double	Alpha(	const double &T);    double	aT(const double &T);    double	dAdT(const double &T);    double	dAdT2(const double &T);    double	lnb(const double &v);    // ideal state @ T,P=0    void	CvCp_T_o(const double &T,                     double &cvo,                     double &cpo);    double	h_T_o(	const double &T);    double	s_T_o(	const double &T);    void	IdealState(            const double &T,            double &cpo,            double &cvo,            double &ho,            double &so);    double	CvDep_T(const double &v,                      const double &T);    void	CvCp_vT(	const double &v,                        const double &T,                        double &cv,                        double &cp);    // EOS partial diff.    void	dPvdPT_vT(            const double &v,            const double &T,            double &dPdv,            double &dPdT);    // thermal factors    void	AvBpGt_vT(            const double &v,            const double &T,            double &Av,            double &Bp,            double &Gt);    // return ln(fugacity)    double	LnPhi_avPT(            const double &a_T,            const double &v,            const double &P,            const double &T);    double	P_vT(	const double &v,                       const double &T);    double	T_vP(	const double &v,                       const double &P);    // return v=f(P=0,T)    void	v0_T(	const double &T,                     double &vl,                     double &vg);    void	v_PT(	const double &P,                     const double &T,                     double &vl,                     double &vg);    void	v_PT(	const double &P,                     const double &T,                     double &vl,                     double &vg,                     double &a_T);    double	u_vT(	const double &v,                       const double &T);    double	s_vT(	const double &v,                       const double &T);    double	h_vT(	const double &v,                       const double &T);    double	h_vPT(	const double &v,                        const double &P,                        const double &T);    void	Prop_vT(const double &v,                    const double &T,                    double &P,                    double &u,                    double &h,                    double &s) override;    void TransProp_PT_l(const double &P,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    void TransProp_vT_l ( const double &v,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    void FlowProp_vT_l(const double &v,const double &T,double &CP,double &ViscDyn,double &Ro,double &ThermCond,double &Prandtl);    void TransProp_PT_g(const double &P,const double &T, double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    void TransProp_vT_g ( const double &v,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    void FlowProp_vT_g(const double &v,const double &T,double &CP,double &ViscDyn,double &Ro,double &ThermCond,double &Prandtl);    //------------------------------------    //------------------------------------    // SATURATION LINE FUNCTIONS    double T_P_s(const double &P) override;    void T_P_s(const double &P, double &T, double &vl, double &vg);    double P_T_s(const double &T) override;    void P_T_s(const double &T, double &P, double &vl, double &vg);    //------------------------------------private:    double h_cst=0,s_cst=0;             //TODO h_cst and s_cst are defined depending on themselves    double aa,bb,mm;    // Cpo coefficients    double c0=0,c1=0,c2=0,c3=0,c4=0;    //TODO c4 not found on file    void	CubicRoots(            const double& c0,            const double& c1,            const double& c2,            const double& c3,            double& r1,            double& r2);    void	QuadraticRoots(            const double& c0,            const double& c1,            const double& c2,            double& r1,            double& r2);    double	P_avT(	const double &a_T,                        const double &v,                        const double &T);    double	u_avT(	const double &a_T,                        const double &v,                        const double &T);    double	h_avT(	const double &a_T,                        const double &v,                        const double &T);    double	h_avPT(	const double &a_T,                         const double &v,                         const double &P,                         const double &T);};