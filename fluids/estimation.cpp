//estimation.cp#include "estimation.h"#include <iostream>#include <cmath>using namespace std;//-------------------------------------------------FluidAprox::FluidAprox(void){	Pc=Tc=Zc=w=0.0; //initialisation des paramètres}//-------------------------------------------------voidFluidAprox::Set(	const double &iPc,                    const double &iTc,                    const double &iZc,					const double &iw){	Pc=iPc;	Tc=iTc;	Zc=iZc; //facteur de compressibilité critique	w=iw; //facteur acentrique}//--------------------------------------------------------#pragma mark === SATURATION LINE FUNCTIONS ===//--------------------------------------------------------//	initialisation with Clapeyron equation,// "Entropie N¡172/173", p.36 ,formula (28)doubleFluidAprox::Tri_Pr_s (const double &Pr){	if (Pr < 1.0)	  return 1.0 / (-3.0 / 7.0 * log10(Pr) / (1.0 + w) + 1.0);	else			  return 1.0;}//-------------------------------------------------doubleFluidAprox::Ti_P_s (const double &P){	return Tc * Tri_Pr_s(P/Pc);}//-------------------------------------------------doubleFluidAprox::Pri_Tr_s (const double &Tr){	if (Tr < 1.0)	  return pow(10.0,-7.0 / 3.0 * (1.0 + w) * (1.0 / Tr - 1.0));	else			  return 1.0;}//-------------------------------------------------doubleFluidAprox::Pi_T_s (const double &T){	return Pc * Pri_Tr_s(T/Tc);}//--------------------------------------------------------#pragma mark === DEW LINE FUNCTIONS  ===//--------------------------------------------------------// vapor pressure line compressibility estimation// RZ v 1.0 functiondoubleFluidAprox::Zi_Tr_gs(const double &Tr){	if (Tr>1.0)	return Zc;	else	return (1.0 - Zc) * sqrt(1.0 - sqrt((Tr - 0.3) / 0.7)) + Zc;}//------------------------------------------------// saturated vapor density estimationdoubleFluidAprox::Vri_PrTr_gs(	const double &Pr,							const double &Tr){	if (Tr < 1.0)	return Tr / Zi_Tr_gs(Tr)/ Pr;	else			return 1.0;}//--------------------------------------------------------#pragma mark === BUBBLE LINE FUNCTIONS  ===//--------------------------------------------------------// Estimation of saturated liquid density Vr [-]// Rackett method, (3-11.9),p. 67 de [1]doubleFluidAprox::Vri_Tr_ls (const double &Tr){	if (Tr<1.0) return  pow(0.29056-0.08775*w,1.0+pow(1-Tr, 2.0/7.0))/Zc;	else		return	1.0;}//------------------------------------------// Estimation of saturated liquid temperature Tr [-]// Rackett method, (3-11.9),p. 67 de [1]doubleFluidAprox::Tri_Vr_ls (const double &Vr){	if (Vr<1.0) return  1.0-pow(log(Vr*Zc)/log(0.29056-0.08775*w)-1.0,3.5);	else		return	1.0;}