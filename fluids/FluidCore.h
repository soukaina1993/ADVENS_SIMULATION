// FluidCore.h#ifndef FLUIDSMAIN_CPP_FLUIDCORE_H#define FLUIDSMAIN_CPP_FLUIDCORE_H//#include "../math/maths.h"#include "estimation.h"// universal gas constant [J/(K mol)]const double R = 8.314471;// iteration precisionconst double v_precision = 1.0E-10;const double P_precision = 1.0E-6;const double T_precision = 1.0E-6;const int maxiter = 150;class FluidCore: public FluidAprox{public:    FluidCore()=default;    virtual ~FluidCore()= default;    //------------------------------------    // BASE FUNCTIONS (explicit functions)    // ideal state @ T,P=0    virtual void    init()=0;    virtual void	CvCp_T_o(const double &T,double &cvo,double &cpo) =0;    virtual double	h_T_o(	const double &T)=0;    virtual double	s_T_o(	const double &T)=0;    virtual void	IdealState(const double &T,double &cpo,double &cvo,double &ho,double &so)=0;    // EOS partial diff.    virtual void	dPvdPT_vT(const double &v,const double &T,double &dPdv,double &dPdT)=0;    // thermal factors    //	virtual double	CvDep_T(const double &v, const double &T)=0;    virtual void	CvCp_vT(const double &v,const double &T,double &cv,double &cp)=0;    virtual void	AvBpGt_vT(const double &v,const double &T,double &Av,double &Bp,double &Gt)=0;    // vPT function (calcul de la pression, du volume massique ou de la temperature)    virtual double	P_vT(const double &v,const double &T)=0;    virtual double	T_vP(const double &v,const double &P)=0;    virtual void	v_PT(const double &P,const double &T,double &vl,double &vg)=0;    // u h s function    virtual double	u_vT(const double &v,const double &T)=0;    virtual double	s_vT(const double &v,const double &T)=0;    virtual double	h_vT(const double &v,const double &T)=0;    virtual double	h_vPT(const double &v,const double &P,const double &T)=0;    virtual void	Prop_vT(const double &v,const double &T,double &P,double &u,double &h,double &s)=0;    // sonic velocity    virtual double	sv_vT(	const double &v,const double &T);//------------------------------------    // SATURATION LINE FUNCTIONS    virtual double	T_P_s(	const double &P)=0;    virtual double	P_T_s(	const double &T)=0;    virtual void	Prop_T_s(	const double &T,double &vl,double &vg,double &P,double &ul,double &ug,double &hl,double &hg,double &sl,double &sg);    void	Prop_T_s(	const double &T,double &P,double &du,double &dh,double &ds);    virtual void	Prop_Tx_s(	const double &T,const double &x,double &v,double &P,double &u,double &h,double &s);    virtual void	Prop_P_s(	const double &P,double &vl,double &vg,double &T,double &ul,double &ug,double &hl,double &hg,double &sl,double &sg);    void	Prop_P_s(	const double &P,double &T,double &du,double &dh,double &ds);    virtual double v_PT_a(const double &P,const double &T);    virtual double v_Tx_a(const double &T, const double &x);    virtual double SurfaceTension(const double &T);    //------------------------------------    // COMMON FUNCTIONS (to all zones)    virtual void	Prop_vT_a(	const double &v,const double &T,double &P,double &u,double &h,double &s,double &x);    virtual double	v_Ph_a(	const double &P,const double &h);    virtual double	v_Ps_a(const double &P,const double &s);    double v_Ps(const double &P,const double &s);    virtual double	T_Ps_a(	const double &P,const double &s);    virtual double	v_PTx_a( const double &P,const double &T, const double &x);    virtual double	P_vT_a(	const double &v,const double &T);    virtual double	u_vT_a(	const double &v,const double &T);    virtual double	h_vT_a(	const double &v,const double &T);    virtual double	s_vT_a(	const double &v,const double &T);    virtual double	T_vP_a(	const double &v,const double &P);    virtual double	h_vP_a(	const double &v,const double &P);    virtual double	v_Th_a(	const double &T,const double &h);    virtual double  P_Th_a(	const double &T,const double &h);    virtual double	v_Ts_a(	const double &T,const double &s);    virtual double	P_Ts_a(	const double &T,const double &s);    virtual double	h_PT_a(	const double &P,const double &T);    virtual double	T_vu(	const double &v,const double &u);    virtual double	T_vh(	const double &v,const double &h);    virtual double	P_vh(	const double &v,const double &h);    virtual double	T_vs(	const double &v,const double &s);    virtual double	P_vs(	const double &v,const double &s);    virtual double	s_Ph_a(	const double &P,const double &h);    virtual double	h_Ps(	const double &P,const double &s);    virtual double	T_hs_a(	const double &h,const double &s);    void	TransProp_PTx(const double &P,const double &T,const double &x,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    virtual void	FlowProp_vT_a(const double &v,const double &T,double &CP,double &ViscDyn,double &Ro,double &ThermCond,double &Prandtl);    virtual void	TransProp_vT_a(const double &v,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl);    virtual void CvCp_PT(const double &P,const double &T,double &cv,double &cp);    //------------------------------------    // VAPOR ZONE FUNCTIONS    virtual void	TransProp_vT_g(const double &v,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void	TransProp_PT_g( const double &P,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void    FlowProp_vT_g(const double &v,const double &T,double &CP,double &ViscDyn,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void	CvCp_vT_g(	const double &v,const double &T,double &cv,double &cp);    virtual void    Prop_PT_g(	const double &P,const double &T,double &v,double &u,double &h,double &s);    void Prop_Ph_g(const double &P,const double &h,double &T,double &v,double &u,double &s);    virtual double	v_PT_g(	const double &P,const double &T);    void	Prop_vu_g(const double &v,const double &u,double &P,double &T,double &h,double &s);    virtual double	P_vT_g(	const double &v,const double &T);    virtual double	u_PT_g(	const double &P,const double &T);    virtual double	h_PT_g(	const double &P,const double &T);    virtual double	s_PT_g(	const double &P,const double &T);    virtual double	v_Ph_g(	const double &P,const double &h);    virtual double	T_hs_g(	const double &h,const double &s);    virtual double	T_vP_g(	const double &v,const double &P);    //------------------------------------    // DEW LINE FUNCTIONS    double	v_T_gs(	const double &T);    //------------------------------------    // BUBBLE LINE FUNCTIONS    double	v_T_ls(	const double &T);    double	T_v_ls(	const double &V);    //------------------------------------    // LIQUID ZONE FUNCTIONS    virtual void    FlowProp_vT_l(const double &v,const double &T,double &CP,double &ViscDyn,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void	TransProp_vT_l(const double &v,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void	TransProp_PT_l(const double &P,const double &T,double &ViscDyn,double &ViscCin,double &Ro,double &ThermCond,double &Prandtl)=0;    virtual void	CvCp_vT_l(	const double &v,const double &T,double &cv,double &cp);    virtual double	v_PT_l(	const double &P,const double &T);    virtual void Prop_PT_l(	const double &P,const double &T,double &v,double &u,double &h,double &s);    virtual double	P_vT_l(	const double &v,const double &T);    virtual double	T_vP_l(	const double &v,const double &P);    double	T_vu_l(	const double &v,const double &u);    void Prop_vu_l(	const double &v,const double &u,double &P,double &T,double &h,double &s);    virtual double	u_PT_l(	const double &P,const double &T);    virtual double	h_PT_l(	const double &P,const double &T);    virtual double	s_PT_l(	const double &P,const double &T);    virtual double	v_Ps_l(	const double &P,const double &s);    virtual double	T_Ps_l(	const double &P,const double &s);    //getters & setters    double getvc();    double getPc();    double getTc();    void set(const char *iFluidName,double ivc,double iPc,double iTc,double iTnb,double iMw,double iw,double iDipM);    void set_ref(double iTref, double ihref, double isref);    double vc,Pc,Tc,uc,hc,sc,Zc; //donnï¿½es en conditions critiques    double	B (int i);    double	E (int i);    double Tref,href,sref,Mw,r;    char *FluidName;protected:    double DipM,w,Tnb;    double Mur,k;};void fluid_define(FluidCore*&fluid, string &fluidname);void fluid_define(FluidCore*&fluid, char* &fluidname);void fluid_define(FluidCore*&fluid, string &fluidname, string &method);void fluid_define(FluidCore*&fluid, char* &fluidname, string &method);double Mfraction(const double &al,                 const double &ag,                 const double &a);#endif